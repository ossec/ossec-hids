<!-- Authors: Alexandr Garaga, Paul Klymenko
-
-  This program is a free software; you can redistribute it
-  and/or modify it under the terms of the GNU General Public
-  License (version 2) as published by the FSF - Free Software
-  Foundation.
-
-  License details: http://www.gnu.org/licenses/old-licenses/gpl-2.0.html
-->

<!-- cPanel messages -->
<group name="syslog,">

<!-- Two same rules but with different decoders because logs have different format -->
  <rule id="11000" level="5">
    <if_sid>2501</if_sid>
    <decoded_as>cpanel-login-failed</decoded_as>
    <regex>FAILED LOGIN</regex>
    <description>Possible attack on the cpanel services</description>
  </rule>

  <rule id="11001" level="5">
    <if_sid>50500</if_sid>
    <decoded_as>postgresql_log</decoded_as>
    <regex>FAILED LOGIN</regex>
    <description>Possible attack on the cpanel services</description>
  </rule>

  <rule id="11002" level="5">
    <if_sid>2501</if_sid>
    <decoded_as>cpanel-access-failed</decoded_as>
    <regex>FAILED LOGIN</regex>
    <description>Possible attack on the cpanel services</description>
  </rule>

<!-- We raise level to send alert considering frequency (6 see doc why) and timeframe (6 minutes) -->
  <rule id="11003" level="10" frequency="4" timeframe="360">
    <if_matched_sid>11001</if_matched_sid>
    <description>Possible breakin attempt</description>
  </rule>

  <rule id="11004" level="10" frequency="4" timeframe="360">
    <if_matched_sid>11000</if_matched_sid>
    <description>Possible breakin attempt</description>
  </rule>

  <rule id="11005" level="10" frequency="4" timeframe="360">
    <if_matched_sid>11002</if_matched_sid>
    <description>Possible breakin attempt</description>
  </rule>

  <rule id="11006" level="3">
    <decoded_as>cpanel-login-success</decoded_as>
    <match>NEW</match>
    <description>Cpanel login success</description>
  </rule>

  <rule id="11007" level="3">
    <if_sid>50500</if_sid>
    <decoded_as>postgresql_log</decoded_as>
    <match>NEW</match>
    <description>Cpanel login success</description>
  </rule>

  <rule id="11008" level="3">
    <decoded_as>cpanel-session-logout</decoded_as>
    <regex>PURGE \S+ logout</regex>
    <description>Cpanel session logout</description>
  </rule>

  <rule id="11009" level="3">
    <if_sid>50500</if_sid>
    <decoded_as>postgresql_log</decoded_as>
    <regex>PURGE \S+ logout</regex>
    <description>Cpanel session logout</description>
  </rule>

  </group> <!-- SYSLOG -->
